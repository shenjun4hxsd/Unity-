##网络系统概念

###1、服务器和主机

在Unity网络系统中，游戏有一个服务器和多个客户端。当没有专用服务器时，其中一个客户端扮演服务器的角色 - 我们把这个客户称为“主机”。

![](/assets/NetworkHost.png)

主机是同一进程中的服务器和客户端。主机使用一种称为`LocalClient`的特殊客户端，而其他客户端则为`RemoteClient`。`LocalClient`通过直接函数调用和消息队列与（本地）服务器进行通信，因为它是在相同的过程中。它实际上与服务器共享场景。`RemoteClients`通过常规网络连接与服务器进行通信。


网络系统的目标之一是将`LocalClients`和`RemoteClients`的代码相同，以便开发人员大多数时候只需要考虑一种类型的客户端。



###2、实例化和生成

在Unity中，`GameObject.Instantiate`创建新的Unity游戏对象。但是，通过网络系统，对象也必须“生成”才能在网络上处于活动状态。这只能在服务器上完成，并导致在连接的客户端上创建对象。产生物体后，生成系统使用分布式对象生命周期管理和状态同步原则。

###3、玩家、本地玩家和权限

在网络系统中，玩家对象是特殊的。有一个玩家对象与每个玩游戏的人相关联，命令被路由到该对象。一个人不能对另一个人的玩家对象调用命令 - 只能是自己的。所以有一个“我的”玩家对象的概念。当添加玩家并且通过连接进行关联时，该玩家对象成为该玩家的客户端上的“本地玩家”对象。有一个属性`isLocalPlayer`设置为true，并且在客户端上的对象上调用的回调`OnStartLocalPlayer()`。下图显示了两个客户及其当地玩家。