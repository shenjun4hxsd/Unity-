##环境

&emsp;&emsp;Lua将其所有的全局变量保存在一个常规的table中，这个table称为“环境（environment）”。这种组织结构的优点在于，其一，不需要再为全局变量创造一种新的数据结构，因此简化了Lua的内部实现。另一个优点是，可以像其他table一样操作这个table。为了便于实施这种操作，Lua将环境table自身保存在一个全局变量`_G`中。例如，以下代码打印了当前环境中所有全局变量的名称：

```lua
    for n in pairs(_G) do print(n) end
```

&emsp;&emsp;在本章中，将看到几种关于环境操作的实用技术。

&emsp;&emsp;

####具有动态名字的全局变量

&emsp;&emsp;对于访问和设置全局变量，通常赋值操作就可以了。不过，有时也会用到一些元编程（meta-programming）的形式。例如，当操作一个全局变量时，而它的名称却存储在另一个变量中，或者需要通过运行时的计算才能得到。为了获取这个变量的值，许多程序员都试图写出这样的代码：

```lua
    value = loadstring("return " .. varname)()
```